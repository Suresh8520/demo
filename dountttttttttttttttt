# Replace the following variables with your repository information
$repositoryUrl = "https://github.com/username/repositoryname"
$branchName = "main" # Replace with the desired branch name
$filePath = "path/to/your/file" # Replace with the path to the file you want to download

# Create a temporary folder to store the downloaded zip file
$tempFolder = New-Item -ItemType Directory -Force -Path (Join-Path $env:TEMP "GitRepoDownload")

# Compose the zip file download URL
$zipFileUrl = "$repositoryUrl/archive/$branchName.zip"

# Download the zip file
$zipFilePath = Join-Path $tempFolder "repo.zip"
Invoke-WebRequest -Uri $zipFileUrl -OutFile $zipFilePath

# Extract the file from the zip archive (optional)
Expand-Archive -Path $zipFilePath -DestinationPath $tempFolder

# Use the $tempFolder to access the downloaded files

# Alternatively, if you only need to extract a specific file from the zip archive, you can use the following:
# Expand-Archive -Path $zipFilePath -DestinationPath $tempFolder -Force
# $fileToExtract = Join-Path $tempFolder "repositoryname-$branchName\$filePath"
# Move-Item -Path $fileToExtract -Destination $tempFolder

# Clean up - remove the temporary folder and zip file
Remove-Item -Path $zipFilePath -Force
Remove-Item -Path $tempFolder -Recurse -Force
